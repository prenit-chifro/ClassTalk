<% content_for :heading do %>
	<a class="mybtn btn btn-link btn-xs pull-left" href="/"><i class="material-icons">&#xE317;</i>HomeWork</a>
<% end %>

<div class="detect-div"></div>
<% if(!@homework_messages.blank?) %>
	<% @homework_messages.each do |message| %>
		<%= render partial: "messages/message", locals: {conversation: message.conversation, message: message} %>
	<% end %>
	
	<%= paginate @homework_messages, window: 1 %>
<% else %>
	<% if(current_user.role == "Teacher") %>
		<h1> You have not posted any HomeWork ! </h1>
	<% else %>
		<h1> No HomeWork Posted </h1>
	<% end %>
<% end %>

<div id="seenStatusModal" class="modal fade" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Seen By Users</h4>
			</div>
			<div class="modal-body">
				
			</div>
		</div>
	</div>
</div>
<div id="submissionModal" class="modal fade" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Submission Report</h4>
			</div>
			<div class="modal-body">
				
			</div>
		</div>
	</div>
</div>
<script>

	$(".classRoute").parents("div.wrapper").find(".navbar-default").css("box-shadow", "none");
	var randomColors = ["#35a5a5",'#8cc4c4','#8b5861',"#d7b26f"];
	$(".ch-thumb").each(function(index) {
        var len = randomColors.length;
        var randomNum = Math.floor(Math.random()*len);
        $(this).css("backgroundColor",randomColors[randomNum]);
        randomColors.slice(randomNum, 1);
    });
	$(".double-checkmark").on("click", function(){
		var messageId = $(this).attr("data-message-id");
		var conversationId = $(this).attr("data-conversation-id");
		$.ajax({
			url: "/conversations/" + conversationId + "/messages/" + messageId + "/seen_by_users.js",  
			type: "GET",
			success: function(data) {
				if(data.trim().length == 0) {
					$("#seenStatusModal").find(".modal-body").html("No one has yet seen this message !");
				} else {
					$("#seenStatusModal").find(".modal-body").html(data);
				}
			}
		});
		$("#seenStatusModal").modal('show');
	});

	$(".checkmark").on("click", function(){
		var messageId = $(this).attr("data-message-id");
		var conversationId = $(this).attr("data-conversation-id");
		$.ajax({
			url: "/conversations/" + conversationId +"/messages/" + messageId + "/acted_by_users.js",  
			type: "GET",
			success: function(data) {
				if(data.trim().length == 0) {
					$("#submissionModal").find(".modal-body").html("No one has yet acted on this message !");
				} else {
					$("#submissionModal").find(".modal-body").html(data);
				}
			}
		});
		$("#submissionModal").modal('show');
	});

</script>
